package com.hotel.hotel_management.service;

import org.springframework.stereotype.Service;
import java.util.*;
import java.util.regex.Pattern;

@Service
public class ChatbotService {

    private final Map<Pattern, String> responses = new LinkedHashMap<>();

    public ChatbotService() {
        initializeResponses();
    }

    private void initializeResponses() {
        responses.put(
            Pattern.compile(".*\\b(suite|luxury|premium)\\b.*", Pattern.CASE_INSENSITIVE),
            "üè® Our Suite rooms are our premium offering! Advantages include:\n" +
            "‚Ä¢ Spacious living area (45m¬≤)\n" +
            "‚Ä¢ King-size bed with premium bedding\n" +
            "‚Ä¢ Separate living room and bedroom\n" +
            "‚Ä¢ Mini bar and coffee machine\n" +
            "‚Ä¢ Luxury bathroom with jacuzzi\n" +
            "‚Ä¢ Panoramic city view\n" +
            "‚Ä¢ 24/7 room service\n" +
            "‚Ä¢ Price: $250 per night\n\n" +
            "Perfect for special occasions or extended stays!"
        );

        responses.put(
            Pattern.compile(".*\\b(double|double room)\\b.*", Pattern.CASE_INSENSITIVE),
            "üõèÔ∏è Our Double rooms offer great comfort:\n" +
            "‚Ä¢ 30m¬≤ comfortable space\n" +
            "‚Ä¢ Queen-size bed\n" +
            "‚Ä¢ Work desk and seating area\n" +
            "‚Ä¢ Private bathroom with shower\n" +
            "‚Ä¢ Free Wi-Fi and TV\n" +
            "‚Ä¢ Climate control\n" +
            "‚Ä¢ Price: $120 per night\n\n" +
            "Ideal for couples or business travelers!"
        );

        responses.put(
            Pattern.compile(".*\\b(single|single room)\\b.*", Pattern.CASE_INSENSITIVE),
            "üõèÔ∏è Our Single rooms are perfect for solo travelers:\n" +
            "‚Ä¢ 20m¬≤ cozy space\n" +
            "‚Ä¢ Comfortable single bed\n" +
            "‚Ä¢ Work desk\n" +
            "‚Ä¢ Private bathroom\n" +
            "‚Ä¢ Free Wi-Fi and TV\n" +
            "‚Ä¢ Climate control\n" +
            "‚Ä¢ Price: $75 per night\n\n" +
            "Great value for budget-conscious guests!"
        );

        responses.put(
            Pattern.compile(".*\\b(upgrade|room upgrade)\\b.*", Pattern.CASE_INSENSITIVE),
            "‚¨ÜÔ∏è Room Upgrades:\n\n" +
            "You can upgrade your room through our Guest Portal!\n" +
            "Simply go to 'Available Upgrades' and select a better room.\n\n" +
            "Upgrades are subject to availability. We'll notify you once approved.\n" +
            "Price difference will be calculated for your remaining stay."
        );

        responses.put(
            Pattern.compile(".*\\b(amenities|facilities|services)\\b.*", Pattern.CASE_INSENSITIVE),
            "üéØ Hotel Amenities & Services:\n\n" +
            "‚Ä¢ 24/7 Front Desk\n" +
            "‚Ä¢ Free Wi-Fi throughout the hotel\n" +
            "‚Ä¢ Fitness Center\n" +
            "‚Ä¢ Restaurant & Bar\n" +
            "‚Ä¢ Room Service\n" +
            "‚Ä¢ Laundry Service\n" +
            "‚Ä¢ Business Center\n" +
            "‚Ä¢ Free Parking\n" +
            "‚Ä¢ Concierge Service\n\n" +
            "Need something specific? Just ask!"
        );

        responses.put(
            Pattern.compile(".*\\b(check-?in|check in|arrival)\\b.*", Pattern.CASE_INSENSITIVE),
            "üïê Check-in Information:\n\n" +
            "‚Ä¢ Check-in time: 3:00 PM\n" +
            "‚Ä¢ Early check-in: Available upon request (subject to availability)\n" +
            "‚Ä¢ Required: Valid ID and booking confirmation\n" +
            "‚Ä¢ Payment: Cash or credit card accepted\n\n" +
            "Please visit the front desk upon arrival!"
        );

        responses.put(
            Pattern.compile(".*\\b(check-?out|checkout|departure)\\b.*", Pattern.CASE_INSENSITIVE),
            "üïê Check-out Information:\n\n" +
            "‚Ä¢ Check-out time: 11:00 AM\n" +
            "‚Ä¢ Late check-out: Available upon request (additional charges may apply)\n" +
            "‚Ä¢ Express check-out: Available at front desk\n\n" +
            "Please return your room key before leaving!"
        );

        responses.put(
            Pattern.compile(".*\\b(breakfast|meal|restaurant|food|dining)\\b.*", Pattern.CASE_INSENSITIVE),
            "üç≥ Dining Options:\n\n" +
            "‚Ä¢ Breakfast Buffet: 7:00 AM - 10:00 AM ($15 per person)\n" +
            "‚Ä¢ Restaurant: 12:00 PM - 10:00 PM (lunch & dinner)\n" +
            "‚Ä¢ Room Service: 24/7 available\n" +
            "‚Ä¢ Bar: 5:00 PM - 12:00 AM\n\n" +
            "Breakfast can be added to your reservation!"
        );

        responses.put(
            Pattern.compile(".*\\b(wifi|internet|password)\\b.*", Pattern.CASE_INSENSITIVE),
            "üì∂ Wi-Fi Information:\n\n" +
            "‚Ä¢ Network: Hotel-Guest-WiFi\n" +
            "‚Ä¢ Free high-speed internet in all rooms\n" +
            "‚Ä¢ Password: Available at check-in or on your room card\n" +
            "‚Ä¢ Technical support: Call extension 0 for assistance"
        );

        responses.put(
            Pattern.compile(".*\\b(parking|car|vehicle)\\b.*", Pattern.CASE_INSENSITIVE),
            "üöó Parking Information:\n\n" +
            "‚Ä¢ Free parking available for all guests\n" +
            "‚Ä¢ Located behind the main building\n" +
            "‚Ä¢ Security cameras 24/7\n" +
            "‚Ä¢ Covered parking spots available\n" +
            "‚Ä¢ Valet service: Available upon request"
        );

        responses.put(
            Pattern.compile(".*\\b(gym|fitness|exercise|workout)\\b.*", Pattern.CASE_INSENSITIVE),
            "üí™ Fitness Center:\n\n" +
            "‚Ä¢ Open 24/7 for hotel guests\n" +
            "‚Ä¢ Modern equipment: treadmills, weights, bikes\n" +
            "‚Ä¢ Towels and water provided\n" +
            "‚Ä¢ Located on ground floor\n" +
            "‚Ä¢ Personal trainer: Available by appointment"
        );

        responses.put(
            Pattern.compile(".*\\b(cancel|cancellation|refund)\\b.*", Pattern.CASE_INSENSITIVE),
            "‚ùå Cancellation Policy:\n\n" +
            "‚Ä¢ Free cancellation up to 48 hours before check-in\n" +
            "‚Ä¢ Late cancellation: 50% charge\n" +
            "‚Ä¢ No-show: Full charge\n\n" +
            "For cancellations, please contact our front desk or email reservations@hotel.com"
        );

        responses.put(
            Pattern.compile(".*\\b(price|cost|rate|expensive|cheap)\\b.*", Pattern.CASE_INSENSITIVE),
            "üí∞ Room Rates:\n\n" +
            "‚Ä¢ Single Room: $75/night\n" +
            "‚Ä¢ Double Room: $120/night\n" +
            "‚Ä¢ Suite: $250/night\n\n" +
            "Rates include:\n" +
            "‚úì Free Wi-Fi\n" +
            "‚úì Free Parking\n" +
            "‚úì Access to all facilities\n\n" +
            "Special rates available for extended stays!"
        );

        responses.put(
            Pattern.compile(".*\\b(pet|dog|cat|animal)\\b.*", Pattern.CASE_INSENSITIVE),
            "üêæ Pet Policy:\n\n" +
            "Unfortunately, we currently do not allow pets, except for certified service animals.\n" +
            "Service animals are always welcome with proper documentation.\n\n" +
            "For assistance, please contact our front desk."
        );

        responses.put(
            Pattern.compile(".*\\b(contact|phone|email|call)\\b.*", Pattern.CASE_INSENSITIVE),
            "üìû Contact Information:\n\n" +
            "‚Ä¢ Front Desk: Extension 0 (from room)\n" +
            "‚Ä¢ Phone: +1 (555) 123-4567\n" +
            "‚Ä¢ Email: info@hotel.com\n" +
            "‚Ä¢ Reservations: reservations@hotel.com\n" +
            "‚Ä¢ Emergency: Dial 911\n\n" +
            "We're here to help 24/7!"
        );

        responses.put(
            Pattern.compile(".*\\b(help|assist|support|question)\\b.*", Pattern.CASE_INSENSITIVE),
            "ü§ù I'm here to help! You can ask me about:\n\n" +
            "‚Ä¢ Room types and features\n" +
            "‚Ä¢ Hotel amenities and services\n" +
            "‚Ä¢ Check-in/out procedures\n" +
            "‚Ä¢ Dining options\n" +
            "‚Ä¢ Room upgrades\n" +
            "‚Ä¢ Policies and procedures\n" +
            "‚Ä¢ Contact information\n\n" +
            "Just type your question!"
        );

        responses.put(
            Pattern.compile(".*\\b(hello|hi|hey|greetings)\\b.*", Pattern.CASE_INSENSITIVE),
            "üëã Hello! Welcome to our hotel!\n\n" +
            "I'm your virtual concierge. I can help you with:\n" +
            "‚Ä¢ Room information and upgrades\n" +
            "‚Ä¢ Hotel services and amenities\n" +
            "‚Ä¢ Check-in/out information\n" +
            "‚Ä¢ And much more!\n\n" +
            "How can I assist you today?"
        );

        responses.put(
            Pattern.compile(".*\\b(thank|thanks|appreciate)\\b.*", Pattern.CASE_INSENSITIVE),
            "üòä You're welcome! If you have any other questions, feel free to ask!\n\n" +
            "Enjoy your stay! üè®"
        );

        responses.put(
            Pattern.compile(".*\\b(bye|goodbye|see you)\\b.*", Pattern.CASE_INSENSITIVE),
            "üëã Goodbye! Have a wonderful day!\n\n" +
            "If you need assistance later, I'll be here! üòä"
        );
    }

    public String processMessage(String message) {
        if (message == null || message.trim().isEmpty()) {
            return "Please type a message so I can assist you! üòä";
        }

        String normalizedMessage = message.trim();

        for (Map.Entry<Pattern, String> entry : responses.entrySet()) {
            if (entry.getKey().matcher(normalizedMessage).matches()) {
                return entry.getValue();
            }
        }

        return "ü§î I'm not sure I understand. Here are some things you can ask me:\n\n" +
               "‚Ä¢ \"What are the advantages of the suite room?\"\n" +
               "‚Ä¢ \"Tell me about room upgrades\"\n" +
               "‚Ä¢ \"What amenities do you offer?\"\n" +
               "‚Ä¢ \"What time is check-in?\"\n" +
               "‚Ä¢ \"How much does a double room cost?\"\n\n" +
               "Or simply type 'help' to see all available topics!";
    }
}

